<!DOCTYPE html>
<!--
https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures MDN 闭包 用闭包模拟私有方法
-->
<html>

<head>
    <title>TODO supply a title</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script>
        //            var Counter = (function () {
        //                var privateCounter = 0;
        //                function changeBy(val) {
        //                    privateCounter += val;
        //                }
        //                return {// 在这里我们可以看到闭包可以不仅仅是一个函数，可以是一个集合
        //                    increment: function () {
        //                        changeBy(1);
        //                    },
        //                    decrement: function () {
        //                        changeBy(-1);
        //                    },
        //                    value: function () {
        //                        return privateCounter;
        //                    }
        //                }
        //            })();//我们只创建了一个词法环境(闭包)，赋给了count（在代码可以看出，它面向外部公开了3个操作接口 increment ，decrement， value。
        //             //这三个公共函数是共享同一个环境的闭包


        var makeCounter = function() {
            var privateCounter = 0;

            function changeBy(val) {
                privateCounter += val;
            }
            return {// 在这里我们可以看到闭包可以不仅仅是一个函数，可以是一个集合
                increment: function() {
                    changeBy(1);
                },
                decrement: function() {
                    changeBy(-1);
                },
                value: function() {
                    return privateCounter;
                }
            }
        };

        function afterWinLoad() {
            document.querySelector('#btn1').addEventListener('click', function() {

                //                    console.log(Counter.value()); /* logs 0 */
                //                    Counter.increment();
                //                    Counter.increment();
                //                    console.log(Counter.value()); /* logs 2 */
                //                    Counter.decrement();
                //                    console.log(Counter.value()); /* logs 1 */


                var Counter1 = makeCounter();
                var Counter2 = makeCounter();
                console.log(Counter1.value()); /* logs 0 */
                Counter1.increment();//调用闭包里头的某个函数
                Counter1.increment();
                console.log(Counter1.value()); /* logs 2 */
                Counter1.decrement();
                console.log(Counter1.value()); /* logs 1 */
                console.log(Counter2.value()); /* logs 0 */
            });
        }
        window.onload = afterWinLoad; //如果代码放入body的后面，可以不这么做
    </script>
    <style></style>
</head>

<body>
    <div>
        <button id="btn1">run</button>
    </div>
</body>

</html>